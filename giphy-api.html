<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy API</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-12 px-2" id="button-div"></div>
    </div>

    <form id="gif-form">

      <!-- Label for Text Box -->
      <div class="row col-md-4 offset-md-7 mt-5">
        <label class="mr-2" for="gif-input">Type here to create a new GifButton&#8482</label>

        <!-- Text Input Box -->
        <input type="text" id="gif-input">
        <br>

        <!-- Submit Button -->
        <input id="set-gif" type="submit" value="GO!">
    </form>
    </div>
    <div id="button-div"></div>
    <div class="col-md-8" id="gif-div"></div>

  </div>
  <!-- <div id="gif-display"></div> -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript">
    var topics = ["Rick and Morty", "Archer", "ATHF", "Futurama", "South Park", ];
    var buttonCount = 0;
    var inputGif = $("#gif-input").val().trim();
    var gifBox = '';

    for (var i = 0; i < topics.length; i++) {
      $("#button-div").append("<button>" + topics[i]);
      var newButton = $("<input>").attr({
        value: inputGif,
        id: "added-button-" + buttonCount,
        type: "button",
        class: "btn btn-primary"

      });
      // $(newButton).html(val);
      // $("#button-div").append(newButton + topics[i]);
    }
    // topics.observe(topics, function () {
    //   for (var i = 0; i < topics.length; i++) {
    //     $("#button-div").append("<button>" + topics[i]);
    //     var newButton = $("<input>").attr({
    //       value: inputGif,
    //       id: "added-button-" + buttonCount,
    //       type: "button",

    //     });
    //   }
    // });

    //function for api call. creates img tag and shows gif
    function searchGifs(searchTerm) {
      var queryURL = "https://api.giphy.com/v1/gifs/random?api_key=k4ZXee2WvMvmYnO7KEc0mHRSEUHV87O7&tag=" + searchTerm;

      $.ajax({
        url: queryURL,
        method: "GET"
      }).then(function (response) {
        console.log(response);
        gifBox = $("<img>").attr("src", response.data.image_original_url);
        // $("#gif-div").empty();
        for (var j = 0; j < 11; j++) {
          $("#gif-div").append(gifBox[j]);
        }
      });
    }

    function createButton() {
      buttonCount++;
      var newButton = $("<input>").attr({
        value: inputGif,
        id: "added-button-" + buttonCount,
        type: "button",

      });
      // $(newButton).html(val);
      $("#button-div").append(newButton);
    }
    //create new button when you click set-gif
    $("#set-gif").on("click", function (event) {
      event.preventDefault();
      inputGif = $("#gif-input").val();
      // createButton(inputGif);
      topics.push(inputGif);
      $("#button-div").empty();
      for (var i = 0; i < topics.length; i++) {
        $("#button-div").append("<button>" + topics[i]);
        var newButton = $("<input>").attr({
          value: inputGif,
          id: "added-button-" + buttonCount,
          type: "button",

        });
        // $(newButton).html(val);
        // $("#button-div").append(newButton + topics[i]);
      }

    });
    // generate gif on button click
    $("#button-div").on("click", '*', function (event) {
      event.preventDefault();
      inputGif = $(this).text();
      console.log("button div click value=", inputGif);
      searchGifs(inputGif);
    });
  </script>

</body>

</html>