<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy API</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
    crossorigin="anonymous">
</head>

<body>
  <div class="container">
    <div id="title-row" class="row ">
      <div class="col-md-7 mb-3">
        <h2 class="">Click any button below to generate 10 gifs from that show.</h2>
        <div class="row d-flex justify-content-center">
          <i class="fas fa-arrow-down arrow1 col-md-3 align-center"></i>
          <i class="fas fa-arrow-down arrow1 col-md-3"></i>
          <i class="fas fa-arrow-down arrow1 col-md-3"></i>
        </div>
      </div>
      <div class="col-md-3 offset-md-1 mb-3">
        <h2>
          Use the GifButton&#8482 to create more buttons of your choosing!</h2>
      </div>
    </div>
    <div class="row">
      <div class="col-md-8 px-2" id="button-div"></div>
      <form id="gif-form" class="col-md-4">
        <div class="">
          <label class="" for="gif-input">Type here to create a new GifButton&#8482</label>
          <input type="text" id="gif-input">
          <br>
          <input class="increaseSpace mb-3 mt-1" id="set-gif" type="submit" value="GIF-IFY!">
      </form>

      </div>
      <!-- <div id="button-div" class="mt-5"></div> -->
      <div id="gif-div" class="col-md-12 row"></div>

    </div>



    <script type="text/javascript">
      var topics = ["Rick and Morty", "Archer", "ATHF", "Futurama", "South Park", "The Simpsons", "King of the Hill",
        "Bob's Burgers", "Family Guy", "Robot Chicken"
      ];
      var buttonCount = 0;
      var inputGif = $("#gif-input").val().trim();
      var gifBox = '';
      $(".container").on('click', '*', function () {
        $("#title-row").hide();
      })

      for (var i = 0; i < topics.length; i++) {
        $("#button-div").append("<button>" + topics[i]);
        var newButton = $("<img>").attr({
          value: inputGif,
          id: "added-button-" + buttonCount,
          type: "button",
          class: "btn btn-primary"
        });
      }

      //function for api call. creates img tag and shows gif
      function searchGifs(searchTerm) {
        var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=k4ZXee2WvMvmYnO7KEc0mHRSEUHV87O7&q=" +
          "$" + searchTerm + "+$random";
        console.log(queryURL);
        $.ajax({
          url: queryURL,
          method: "GET"
        }).then(function (response) {
          $("#gif-div").empty();
          for (var j = 0; j < 10; j++) {
            buttonCount++;
            gifBox = $("<img>").attr({
              data: response.data[j].rating,
              id: "added-button-" + buttonCount,
              type: "button",
              class: "btn btn-primary addedGif",
              src: response.data[j].images.original_still.url,
              still: response.data[j].images.original_still.url,
              animate: response.data[j].images.original.url,
              state: "still"
            });
            newDiv = $("<div id='new-id-" + buttonCount + "' " + "class='col-md-auto addedGif'>")
            $("#gif-div").append(newDiv);
            $(newDiv).html("rating: " + response.data[j].rating + "  ");
            $(newDiv).append(gifBox);
          }
        });
      }

      function createButton() {
        buttonCount++;
        var newButton = $("<input>").attr({
          value: inputGif,
          id: "added-button-" + buttonCount,
          type: "button",
        });
        $("#button-div").append(newButton);
      }

      //create new button when you click set-gif
      $("#set-gif").on("click", function (event) {
        event.preventDefault();
        inputGif = $("#gif-input").val();
        // createButton(inputGif);
        topics.push(inputGif);
        $("#button-div").empty();
        for (var i = 0; i < topics.length; i++) {
          $("#button-div").append("<button>" + topics[i]);
          var newButton = $("<input>").attr({
            value: inputGif,
            id: "added-button-" + buttonCount,
            type: "button",
          });
        }
        $("button").addClass("btn btn-primary");
      });

      // generate gif on button click
      $("#button-div").on("click", '*', function (event) {
        event.preventDefault();
        inputGif = $(this).text();
        console.log("button div click value=", inputGif);
        searchGifs(inputGif);
      });
      //start/stop animations
      $("#gif-div").on("click", '*', function () {
        console.log('test');
        var state = $(this).attr("state");
        if (state === "still") {
          $(this).attr("src", $(this).attr("animate"));
          $(this).attr("state", "animate");
        } else {
          $(this).attr("src", $(this).attr("still"));
          $(this).attr("state", "still");
        }
      });
      $("button").addClass("btn btn-primary");
    </script>

</body>

</html>